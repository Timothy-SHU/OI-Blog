<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/OI-Blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/OI-Blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/OI-Blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/OI-Blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/OI-Blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"timothy-shu.github.io","root":"/OI-Blog/","images":"/OI-Blog/images","scheme":"Gemini","darkmode":false,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/OI-Blog/js/config.js"></script>

    <meta name="description" content="ProblemSightseeing Plan$\mathrm{Time;limit:;8;Sec}$$\mathrm{Memory;limit:;256;MB}$ StatementJoisino is planning on touring Takahashi Town. The town is divided into square sections by north-south and e">
<meta property="og:type" content="article">
<meta property="og:title" content="AGC018E Sightseeing Plan &lt;组合数学&gt;">
<meta property="og:url" content="https://timothy-shu.github.io/OI-Blog/2018/10/02/AGC018E%20Sightseeing%20Plan%20%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="ProblemSightseeing Plan$\mathrm{Time;limit:;8;Sec}$$\mathrm{Memory;limit:;256;MB}$ StatementJoisino is planning on touring Takahashi Town. The town is divided into square sections by north-south and e">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-10-01T16:00:00.000Z">
<meta property="article:modified_time" content="2024-04-21T09:03:07.489Z">
<meta property="article:author" content="Azrael">
<meta property="article:tag" content="计数">
<meta property="article:tag" content="组合数学">
<meta property="article:tag" content="AtCoder">
<meta property="article:tag" content="AGC">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://timothy-shu.github.io/OI-Blog/2018/10/02/AGC018E%20Sightseeing%20Plan%20%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://timothy-shu.github.io/OI-Blog/2018/10/02/AGC018E%20Sightseeing%20Plan%20%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/","path":"2018/10/02/AGC018E Sightseeing Plan 组合数学/","title":"AGC018E Sightseeing Plan \u003c组合数学>"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>AGC018E Sightseeing Plan <组合数学> | NIRVANA</title>
  






  <noscript>
    <link rel="stylesheet" href="/OI-Blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/OI-Blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">NIRVANA</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">OI Journal</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/OI-Blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="https://timothy-shu.github.io/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/OI-Blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/OI-Blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Problem"><span class="nav-number">1.</span> <span class="nav-text">Problem</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Sightseeing-Plan"><span class="nav-number">1.1.</span> <span class="nav-text">Sightseeing Plan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Statement"><span class="nav-number">1.2.</span> <span class="nav-text">Statement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constraints"><span class="nav-number">1.3.</span> <span class="nav-text">Constraints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Input"><span class="nav-number">1.4.</span> <span class="nav-text">Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Output"><span class="nav-number">1.5.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample"><span class="nav-number">1.6.</span> <span class="nav-text">Sample</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Translation"><span class="nav-number">2.</span> <span class="nav-text">Translation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Solution"><span class="nav-number">3.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Code"><span class="nav-number">4.</span> <span class="nav-text">Code</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Azrael</p>
  <div class="site-description" itemprop="description">Former OIer</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/OI-Blog/archives/">
          <span class="site-state-item-count">248</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/OI-Blog/tags/">
        <span class="site-state-item-count">152</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://timothy-shu.github.io/OI-Blog/2018/10/02/AGC018E%20Sightseeing%20Plan%20%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/OI-Blog/images/avatar.gif">
      <meta itemprop="name" content="Azrael">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NIRVANA">
      <meta itemprop="description" content="Former OIer">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="AGC018E Sightseeing Plan <组合数学> | NIRVANA">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AGC018E Sightseeing Plan <组合数学>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2018-10-02 00:00:00" itemprop="dateCreated datePublished" datetime="2018-10-02T00:00:00+08:00">2018-10-02</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><h3 id="Sightseeing-Plan"><a href="#Sightseeing-Plan" class="headerlink" title="Sightseeing Plan"></a>Sightseeing Plan</h3><p>$\mathrm{Time;limit:;8;Sec}$<br>$\mathrm{Memory;limit:;256;MB}$</p>
<h3 id="Statement"><a href="#Statement" class="headerlink" title="Statement"></a>Statement</h3><p>Joisino is planning on touring Takahashi Town. The town is divided into square sections by north-south and east-west lines. We will refer to the section that is the $x^{th}$ from the west and the $y^{th}$ from the north as $(x,y)$.<br>Joisino thinks that a touring plan is good if it satisfies the following conditions:<br>Let $(p,q)$ be the section where she starts the tour. Then, $X_1\le p\le X_2$ and $Y_1\le q\le Y_2$ hold.<br>Let $(s,t)$ be the section where she has lunch. Then, $X_3\le s\le X_4$ and $Y_3\le t\le Y_4$ hold.<br>Let $(u,v)$ be the section where she ends the tour. Then, $X_5\le u\le X_6$ and $Y_5\le v\le Y_6$ hold.<br>By repeatedly moving to the adjacent section (sharing a side), she travels from the starting section to the ending section in the shortest distance, passing the lunch section on the way.<br>Two touring plans are considered different if at least one of the following is different: the starting section, the lunch section, the ending section, and the sections that are visited on the way. Joisino would like to know how many different good touring plans there are. Find the number of the different good touring plans. Since it may be extremely large, find the count modulo $10^9+7$.</p>
<h3 id="Constraints"><a href="#Constraints" class="headerlink" title="Constraints"></a>Constraints</h3><p>$1\le X_1\le X_2&lt;X_3\le X_4&lt;X_5\le X_6\le 10^6$<br>$1\le Y_1\le Y_2&lt;Y_3\le Y_4&lt;Y_5\le Y_6\le 10^6$</p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>Input is given from Standard Input in the following format:<br>$$<br>\begin{matrix}<br>X_1&amp;X_2&amp;X_3&amp;X_4&amp;X_5&amp;X_6\<br>Y_1&amp;Y_2&amp;Y_3&amp;Y_4&amp;Y_5&amp;Y_6\<br>\end{matrix}<br>$$</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>Print the number of the different good touring plans, modulo $10^9+7$.</p>
<span id="more"></span>
<h3 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h3><p><strong>Input #1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 1 2 2 3 4</span><br><span class="line">1 1 2 2 3 3</span><br></pre></td></tr></table></figure>
<p><strong>Output #1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10</span><br></pre></td></tr></table></figure>
<p><strong>Explanation #1</strong><br>The starting section will always be $(1,1)$, and the lunch section will always be $(2,2)$. There are four good touring plans where $(3,3)$ is the ending section, and six good touring plans where $(4,3)$ is the ending section. Therefore, the answer is $6+4&#x3D;10$.<br><strong>Input #2</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 2 3 4 5 6</span><br><span class="line">1 2 3 4 5 6</span><br></pre></td></tr></table></figure>
<p><strong>Output #2</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2346</span><br></pre></td></tr></table></figure>
<p><strong>Input #3</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">77523 89555 420588 604360 845669 973451</span><br><span class="line">2743 188053 544330 647651 709337 988194</span><br></pre></td></tr></table></figure>
<p><strong>Output #3</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">137477680</span><br></pre></td></tr></table></figure>

<p>标签：<code>组合数学</code></p>
<h2 id="Translation"><a href="#Translation" class="headerlink" title="Translation"></a>Translation</h2><p>给出三个矩形$A:(X_1,Y_1)\sim(X_2,Y_2)$，$B:(X_3,Y_3)\sim(X_4,Y_4)$，$C:(X_5,Y_5)\sim(X_6,Y_6)$。<br>求从$A$中任意一点出发，经过$B$中任意<strong>指定</strong>一点，到达$C$中任意一点，且只能向上走或向右走的路径数。<br>注意：如果两条路径相同，而在$B$中经过的<strong>指定</strong>点不同，则视为两条不同路径。即，可将一条路径看成二元组$(path,P)$，其中$P$是在$B$中指定经过的点，若两者中任意一者不同，则视为两条不同路径。</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>挺麻烦的计数。</p>
<p>设$F(x,y)$为从$(0,0)$走到$(x,y)$的方案数，那么有$F(x,y)&#x3D;\frac{(x+y)!}{x!y!}$。<br><strong>引理 1</strong>：$\sum_{y&#x3D;0}^{Y}F(X,y)&#x3D;F(X+1,Y)$。<br><strong>证明</strong>：考虑所有从$(0,0)$到$(X+1,Y)$的路径，其一定经过其仅经过一条形如$(X,i)\to(X+1,i)$的边。而经过$(X,i)\to(X+1,i)$的路径的条数恰好为$F(X,i)$，于是有$\sum_{y&#x3D;0}^{Y}F(X,y)&#x3D;F(X+1,Y)$。<br><strong>引理 2</strong>：$\sum_{x&#x3D;0}^{X}\sum_{y&#x3D;0}^{Y}F(x,y)&#x3D;F(X+1,Y+1)-1$<br><strong>证明</strong>：<br>$$<br>\begin{aligned}<br>\sum_{x&#x3D;0}^{X}\sum_{y&#x3D;0}^{Y}F(x,y)<br>&amp;&#x3D;\sum_{x&#x3D;0}^{X}F(x+1,Y)\<br>&amp;&#x3D;-F(0,Y)+\sum_{x&#x3D;0}^{X+1}F(x,Y)\<br>&amp;&#x3D;F(X+1,Y+1)-1<br>\end{aligned}<br>$$<br>由以上可用类似二维前缀和的方法得到<br>$$<br>\sum_{x&#x3D;X_1}^{X_2}\sum_{y&#x3D;Y_1}^{Y_2}F(x,y)&#x3D;F(X_1,Y_1)-F(X_1,Y_2+1)-F(X_2+1,Y_1)+F(X_2+1,Y_2+1)<br>$$<br>于是我们有了一个计算从$(0,0)$到一个矩形中的任意点的路径个数。类似地，$4\times4$枚举两个矩形各四个基准点即可对于任意在两个矩形中间的点$(x,y)$计算从$A$到其再到$B$的路径条数。</p>
<p>对于一条路径，其一定进入$B$一次再从$B$出去一次，设入口和出口曼哈顿距离为$dis$，则其一定能对应$dis+1$条$B$中<strong>指定点</strong>不同的路径。而从左边和下边的每个点进入于从上边和右边的每个点出去的贡献都是可以拆开的，于是枚举入点计算贡献，再枚举出点计算贡献。<br>具体地，</p>
<ul>
<li>对于$X_3\le x\le X_4$，从$(x,Y_3)$进入的路径每条路贡献均为$-(x+Y_3)$</li>
<li>对于$Y_3\le y\le Y_4$，从$(X_3,y)$进入的路径每条路贡献均为$-(X_3+y)$</li>
<li>对于$X_3\le x\le X_4$，从$(x,Y_4)$出去的路径每条路贡献均为$x+Y_4+1$</li>
<li>对于$Y_3\le y\le Y_4$，从$(X_4,y)$出去的路径每条路贡献均为$X_4+y+1$</li>
</ul>
<p>附上官方题解</p>
<div class="pdf-container" data-target="https://files.cnblogs.com/files/AzraelDeath/AGC018E.pdf" data-height="500px"></div>


<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX 2000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> P 1000000007</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> lnt;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">	x = <span class="number">0</span>; <span class="type">int</span> c = <span class="built_in">getchar</span>(), f = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(c); c = <span class="built_in">getchar</span>()) <span class="keyword">if</span> (c == <span class="number">45</span>) f = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span> (; <span class="built_in">isdigit</span>(c); c = <span class="built_in">getchar</span>()) (x *= <span class="number">10</span>) += f*(c-<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">lnt fac[MX+<span class="number">5</span>], inv[MX+<span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> X1, X2, X3, X4, X5, X6;</span><br><span class="line"><span class="type">int</span> Y1, Y2, Y3, Y4, Y5, Y6;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= MX; i++) fac[i] = fac[i<span class="number">-1</span>]*i%P;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= MX; i++) inv[i] = (P-P/i*inv[P%i]%P)%P;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= MX; i++) inv[i] = inv[i]*inv[i<span class="number">-1</span>]%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lnt <span class="title">F</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;<span class="keyword">return</span> fac[n+m]*inv[n]%P*inv[m]%P;&#125;</span><br><span class="line"><span class="function">lnt <span class="title">calc</span><span class="params">(<span class="type">int</span> sx, <span class="type">int</span> sy, <span class="type">int</span> tx, <span class="type">int</span> ty)</span> </span>&#123;</span><br><span class="line">	lnt ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> x = X3, y = Y3; x &lt;= X4; x++)</span><br><span class="line">		ret = (ret+<span class="number">1LL</span>*(P-x-y)*<span class="built_in">F</span>(x-sx, y-sy<span class="number">-1</span>)%P*<span class="built_in">F</span>(tx-x, ty-y)%P)%P;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> x = X3, y = Y3; y &lt;= Y4; y++)</span><br><span class="line">		ret = (ret+<span class="number">1LL</span>*(P-x-y)*<span class="built_in">F</span>(x-sx<span class="number">-1</span>, y-sy)%P*<span class="built_in">F</span>(tx-x, ty-y)%P)%P;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> x = X3, y = Y4; x &lt;= X4; x++)</span><br><span class="line">		ret = (ret+<span class="number">1LL</span>*(x+y+<span class="number">1</span>)*<span class="built_in">F</span>(x-sx, y-sy)%P*<span class="built_in">F</span>(tx-x, ty-y<span class="number">-1</span>)%P)%P;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> x = X4, y = Y3; y &lt;= Y4; y++)</span><br><span class="line">		ret = (ret+<span class="number">1LL</span>*(x+y+<span class="number">1</span>)*<span class="built_in">F</span>(x-sx, y-sy)%P*<span class="built_in">F</span>(tx-x<span class="number">-1</span>, ty-y)%P)%P;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">init</span>(); lnt ans = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">read</span>(X1), <span class="built_in">read</span>(X2), <span class="built_in">read</span>(X3), <span class="built_in">read</span>(X4), <span class="built_in">read</span>(X5), <span class="built_in">read</span>(X6);</span><br><span class="line">	<span class="built_in">read</span>(Y1), <span class="built_in">read</span>(Y2), <span class="built_in">read</span>(Y3), <span class="built_in">read</span>(Y4), <span class="built_in">read</span>(Y5), <span class="built_in">read</span>(Y6);</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y1<span class="number">-1</span>, X5, Y5))%P;</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y1<span class="number">-1</span>, X6+<span class="number">1</span>, Y6+<span class="number">1</span>))%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y1<span class="number">-1</span>, X5, Y6+<span class="number">1</span>)+P)%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y1<span class="number">-1</span>, X6+<span class="number">1</span>, Y5)+P)%P;</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X2, Y2, X5, Y5))%P;</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X2, Y2, X6+<span class="number">1</span>, Y6+<span class="number">1</span>))%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X2, Y2, X5, Y6+<span class="number">1</span>)+P)%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X2, Y2, X6+<span class="number">1</span>, Y5)+P)%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y2, X5, Y5)+P)%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y2, X6+<span class="number">1</span>, Y6+<span class="number">1</span>)+P)%P;</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y2, X5, Y6+<span class="number">1</span>))%P;</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X1<span class="number">-1</span>, Y2, X6+<span class="number">1</span>, Y5))%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X2, Y1<span class="number">-1</span>, X5, Y5)+P)%P;</span><br><span class="line">	ans = (ans-<span class="built_in">calc</span>(X2, Y1<span class="number">-1</span>, X6+<span class="number">1</span>, Y6+<span class="number">1</span>)+P)%P;</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X2, Y1<span class="number">-1</span>, X5, Y6+<span class="number">1</span>))%P;</span><br><span class="line">	ans = (ans+<span class="built_in">calc</span>(X2, Y1<span class="number">-1</span>, X6+<span class="number">1</span>, Y5))%P;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/OI-Blog/tags/%E8%AE%A1%E6%95%B0/" rel="tag"># 计数</a>
              <a href="/OI-Blog/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" rel="tag"># 组合数学</a>
              <a href="/OI-Blog/tags/AtCoder/" rel="tag"># AtCoder</a>
              <a href="/OI-Blog/tags/AGC/" rel="tag"># AGC</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/OI-Blog/2018/10/02/%E3%80%90ACM-ICPC%202018%20%E5%8D%97%E4%BA%AC%E8%B5%9B%E5%8C%BA%E7%BD%91%E7%BB%9C%E9%A2%84%E8%B5%9B%E3%80%91Set%20%E5%B9%B6%E6%9F%A5%E9%9B%86+Trie%E5%90%88%E5%B9%B6/" rel="prev" title="【ACM-ICPC 2018 南京赛区网络预赛】Set <并查集+Trie合并>">
                  <i class="fa fa-chevron-left"></i> 【ACM-ICPC 2018 南京赛区网络预赛】Set <并查集+Trie合并>
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/OI-Blog/2018/10/03/BZOJ3033%20%E5%A4%AA%E9%BC%93%E8%BE%BE%E4%BA%BA%20%E6%AC%A7%E6%8B%89%E5%9B%9E%E8%B7%AF/" rel="next" title="BZOJ3033 太鼓达人 <欧拉回路>">
                  BZOJ3033 太鼓达人 <欧拉回路> <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Azrael</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/OI-Blog/js/comments.js"></script><script src="/OI-Blog/js/utils.js"></script><script src="/OI-Blog/js/motion.js"></script><script src="/OI-Blog/js/next-boot.js"></script>

  

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/OI-Blog/lib/pdf/web/viewer.html"}</script>
  <script src="/OI-Blog/js/third-party/tags/pdf.js"></script>


  <script src="/OI-Blog/js/third-party/fancybox.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/OI-Blog/js/third-party/math/mathjax.js"></script>



</body>
</html>
